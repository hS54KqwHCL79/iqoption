<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step 2 LeoMarkets</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
	<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body style="width:315px; height:600px;">
<div class = "header">
 <img src = "images/logo.png" style = "height:70px;">
</div>

<div class = "cryp_text">
 Buy Cryptocurrency With a Bank Card
</div>

 <div class = "left_side_form">

  <form id="caffForm">
    <div class="row">
        <div class="col-md-12 form-group">
            <label id = "name_label" class="control-label">Name</label>
            <input type="text" name="firstname" readonly  id = "name_input" placeholder="Name" class="form-control" pattern="^[^\\0-9!@#$%^&amp;*()-]{3,15}$" required=""
                title="Please enter 3-15 characters (alphabets only)">
        </div>
            <input type="hidden" type="text"  name="lastname" class="form-control" value="Second name" />
    </div>
    <div class="row">
            <!-- <label class="control-label">Страна</label> -->
            <select style="display: none" name="countryabbr" id="countryData_gaff" class="form-control bfh-countries email-form" data-country="AF" required="">
                <option value=""></option>
                <option value="AF">Afghanistan</option>
                <option value="AL">Albania</option>
                <option value="DZ">Algeria</option>
                <option value="AS">American Samoa</option>
                <option value="AD">Andorra</option>
                <option value="AO">Angola</option>
                <option value="AI">Anguilla</option>
                <option value="AQ">Antarctica</option>
                <option value="AG">Antigua and Barbuda</option>
                <option value="AR">Argentina</option>
                <option value="AM">Armenia</option>
                <option value="AW">Aruba</option>
                <option value="AU">Australia</option>
                <option value="AT">Austria</option>
                <option value="AZ">Azerbaijan</option>
                <option value="BH">Bahrain</option>
                <option value="BD">Bangladesh</option>
                <option value="BB">Barbados</option>
                <option value="BY">Belarus</option>
                <option value="BE">Belgium</option>
                <option value="BZ">Belize</option>
                <option value="BJ">Benin</option>
                <option value="BM">Bermuda</option>
                <option value="BT">Bhutan</option>
                <option value="BO">Bolivia</option>
                <option value="BA">Bosnia and Herzegovina</option>
                <option value="BW">Botswana</option>
                <option value="BV">Bouvet Island</option>
                <option value="BR">Brazil</option>
                <option value="IO">British Indian Ocean Territory</option>
                <option value="VG">British Virgin Islands</option>
                <option value="BN">Brunei</option>
                <option value="BG">Bulgaria</option>
                <option value="BF">Burkina Faso</option>
                <option value="BI">Burundi</option>
                <option value="CI">Côte d'Ivoire</option>
                <option value="KH">Cambodia</option>
                <option value="CM">Cameroon</option>
                <option value="CA">Canada</option>
                <option value="CV">Cape Verde</option>
                <option value="KY">Cayman Islands</option>
                <option value="CF">Central African Republic</option>
                <option value="TD">Chadddd</option>
                <option value="CL">Chile</option>
                <option value="CN">China</option>
                <option value="CX">Christmas Island</option>
                <option value="CC">Cocos (Keeling) Islands</option>
                <option value="CO">Colombia</option>
                <option value="KM">Comoros</option>
                <option value="CG">Congo</option>
                <option value="CK">Cook Islands</option>
                <option value="CR">Costa Rica</option>
                <option value="HR">Croatia</option>
                <option value="CU">Cuba</option>
                <option value="CY">Cyprus</option>
                <option value="CZ">Czech Republic</option>
                <option value="CD">Democratic Republic of the Congo</option>
                <option value="DK">Denmark</option>
                <option value="DJ">Djibouti</option>
                <option value="DM">Dominica</option>
                <option value="DO">Dominican Republic</option>
                <option value="TP">East Timor</option>
                <option value="EC">Ecuador</option>
                <option value="EG">Egypt</option>
                <option value="SV">El Salvador</option>
                <option value="GQ">Equatorial Guinea</option>
                <option value="ER">Eritrea</option>
                <option value="EE">Estonia</option>
                <option value="ET">Ethiopia</option>
                <option value="FO">Faeroe Islands</option>
                <option value="FK">Falkland Islands</option>
                <option value="FJ">Fiji</option>
                <option value="FI">Finland</option>
                <option value="MK">Former Yugoslav Republic of Macedonia</option>
                <option value="FR">France</option>
                <option value="FX">France, Metropolitan</option>
                <option value="GF">French Guiana</option>
                <option value="PF">French Polynesia</option>
                <option value="TF">French Southern Territories</option>
                <option value="GA">Gabon</option>
                <option value="GE">Georgia</option>
                <option value="DE">Germany</option>
                <option value="GH">Ghana</option>
                <option value="GI">Gibraltar</option>
                <option value="GR">Greece</option>
                <option value="GL">Greenland</option>
                <option value="GD">Grenada</option>
                <option value="GP">Guadeloupe</option>
                <option value="GU">Guam</option>
                <option value="GT">Guatemala</option>
                <option value="GN">Guinea</option>
                <option value="GW">Guinea-Bissau</option>
                <option value="GY">Guyana</option>
                <option value="HT">Haiti</option>
                <option value="HM">Heard and Mc Donald Islands</option>
                <option value="HN">Honduras</option>
                <option value="HK">Hong Kong</option>
                <option value="HU">Hungary</option>
                <option value="IS">Iceland</option>
                <option value="IN">India</option>
                <option value="ID">Indonesia</option>
                <option value="IR">Iran</option>
                <option value="IQ">Iraq</option>
                <option value="IE">Ireland</option>
                <option value="IL">Israel</option>
                <option value="IT">Italy</option>
                <option value="JM">Jamaica</option>
                <option value="JP">Japan</option>
                <option value="JO">Jordan</option>
                <option value="KZ">Kazakhstan</option>
                <option value="KE">Kenya</option>
                <option value="KI">Kiribati</option>
                <option value="KW">Kuwait</option>
                <option value="KG">Kyrgyzstan</option>
                <option value="LA">Laos</option>
                <option value="LV">Latvia</option>
                <option value="LB">Lebanon</option>
                <option value="LS">Lesotho</option>
                <option value="LR">Liberia</option>
                <option value="LY">Libya</option>
                <option value="LI">Liechtenstein</option>
                <option value="LT">Lithuania</option>
                <option value="LU">Luxembourg</option>
                <option value="MO">Macau</option>
                <option value="MG">Madagascar</option>
                <option value="MW">Malawi</option>
                <option value="MY">Malaysia</option>
                <option value="MV">Maldives</option>
                <option value="ML">Mali</option>
                <option value="MT">Malta</option>
                <option value="MH">Marshall Islands</option>
                <option value="MQ">Martinique</option>
                <option value="MR">Mauritania</option>
                <option value="MU">Mauritius</option>
                <option value="YT">Mayotte</option>
                <option value="MX">Mexico</option>
                <option value="FM">Micronesia</option>
                <option value="MD">Moldova</option>
                <option value="MC">Monaco</option>
                <option value="MN">Mongolia</option>
                <option value="ME">Montenegro</option>
                <option value="MS">Montserrat</option>
                <option value="MA">Morocco</option>
                <option value="MZ">Mozambique</option>
                <option value="MM">Myanmar</option>
                <option value="NA">Namibia</option>
                <option value="NR">Nauru</option>
                <option value="NP">Nepal</option>
                <option value="NL">Netherlands</option>
                <option value="AN">Netherlands Antilles</option>
                <option value="NC">New Caledonia</option>
                <option value="NZ">New Zealand</option>
                <option value="NI">Nicaragua</option>
                <option value="NE">Niger</option>
                <option value="NG">Nigeria</option>
                <option value="NU">Niue</option>
                <option value="NF">Norfolk Island</option>
                <option value="KP">North Korea</option>
                <option value="MP">Northern Marianas</option>
                <option value="NO">Norway</option>
                <option value="OM">Oman</option>
                <option value="PK">Pakistan</option>
                <option value="PW">Palau</option>
                <option value="PS">Palestine</option>
                <option value="PA">Panama</option>
                <option value="PG">Papua New Guinea</option>
                <option value="PY">Paraguay</option>
                <option value="PE">Peru</option>
                <option value="PH">Philippines</option>
                <option value="PN">Pitcairn Islands</option>
                <option value="PL">Poland</option>
                <option value="PT">Portugal</option>
                <option value="PR">Puerto Rico</option>
                <option value="QA">Qatar</option>
                <option value="RE">Reunion</option>
                <option value="RO">Romania</option>
                <option value="RU">Russia</option>
                <option value="RW">Rwanda</option>
                <option value="ST">Sao Tome and Principe</option>
                <option value="SH">Saint Helena</option>
                <option value="PM">St. Pierre and Miquelon</option>
                <option value="KN">Saint Kitts and Nevis</option>
                <option value="LC">Saint Lucia</option>
                <option value="VC">Saint Vincent and the Grenadines</option>
                <option value="WS">Samoa</option>
                <option value="SM">San Marino</option>
                <option value="SA">Saudi Arabia</option>
                <option value="SN">Senegal</option>
                <option value="RS">Serbia</option>
                <option value="SC">Seychelles</option>
                <option value="SL">Sierra Leone</option>
                <option value="SG">Singapore</option>
                <option value="SK">Slovakia</option>
                <option value="SI">Slovenia</option>
                <option value="SB">Solomon Islands</option>
                <option value="SO">Somalia</option>
                <option value="ZA">South Africa</option>
                <option value="GS">South Georgia and the South Sandwich Islands</option>
                <option value="KR">South Korea</option>
                <option value="ES">Spain</option>
                <option value="LK">Sri Lanka</option>
                <option value="SD">Sudan</option>
                <option value="SR">Suriname</option>
                <option value="SJ">Svalbard and Jan Mayen Islands</option>
                <option value="SZ">Swaziland</option>
                <option value="SE">Sweden</option>
                <option value="CH">Switzerland</option>
                <option value="SY">Syria</option>
                <option value="TW">Taiwan</option>
                <option value="TJ">Tajikistan</option>
                <option value="TZ">Tanzania</option>
                <option value="TH">Thailand</option>
                <option value="BS">The Bahamas</option>
                <option value="GM">The Gambia</option>
                <option value="TG">Togo</option>
                <option value="TK">Tokelau</option>
                <option value="TO">Tonga</option>
                <option value="TT">Trinidad and Tobago</option>
                <option value="TN">Tunisia</option>
                <option value="TR">Turkey</option>
                <option value="TM">Turkmenistan</option>
                <option value="TC">Turks and Caicos Islands</option>
                <option value="TV">Tuvalu</option>
                <option value="VI">US Virgin Islands</option>
                <option value="UG">Uganda</option>
                <option value="AE">United Arab Emirates</option>
                <option value="GB">United Kingdom</option>
                <option value="UM">United States Minor Outlying Islands</option>
                <option value="UY">Uruguay</option>
                <option value="UZ">Uzbekistan</option>
                <option value="VU">Vanuatu</option>
                <option value="VA">Vatican City</option>
                <option value="VE">Venezuela</option>
                <option value="VN">Vietnam</option>
                <option value="WF">Wallis and Futuna Islands</option>
                <option value="EH">Western Sahara</option>
                <option value="YE">Yemen</option>
                <option value="ZM">Zambia</option>
                <option value="ZW">Zimbabwe</option>
            </select>
        <div class="col-md-12 form-group">
            <label class="control-label" id = "telephone">Telephone</label>
            <input id="phoneOrig_gaff_gaff" readonly  type="text" class="form-control bfh-phone" data-country="countryData_gaff" data-toggle="popover"
                data-trigger="manual" data-placement="top" data-content="You have to use a VALID number in order to continue." pattern=".{9,20}"
                title="Please enter valid number"  required="">
        </div>
    </div>
    <div class="row" class = "line_for">
        <div class="col-md-12 form-group">
            <label class="control-label" id = "email_input">Email</label>
            <input type="email"  id = "input_email" readonly name="email" placeholder="Email" class="form-control" required="">
        </div>
            <input id="formPassword" type="hidden" id = "pass_input" name="password" placeholder="Пароль" class="form-control" pattern=".{6,12}" required="" title="Please enter 6-12 characters">
    </div>
    <div class="checkbox" style = "margin-left:-27px">
        <label class = "label_check">
            <input type="checkbox" style = "margin:12px 0 0" name="terms" checked="" required="">
            <a data-toggle="modal" data-target="#terms" id = "terms_of_use" href = "https://leomarkets.com/legal/terms-and-conditions" target = "_blank">
              I accept terms of use 
			</a>
        </label>
    </div>
    <button type="submit" class = "big_blue_button" style = "margin-left:12px; height:59px; width:270px; align-items:center; justify-content:center; color:white;">
	 <span id = "button_header">Sign Up</span>
	 <span id = "button_text_title" class = "little">and go to payment</span>
	</button>
    <div class="alert alert-danger hidden-message" style = "display:none;" >Произошла Ошибка</div> 
    <input type="hidden" name="phone" id="phone">
    <input type="hidden" name="prefix" id="prefix" value="1">
  </form>
 </div>

</div>

<script>
$(document).ready(function()
{

 var Status = 1
 var lang = 'eng'

/*Reseting data from data.json*/
function resetLang(jsonData)
{
 $(".cryp_text").text(jsonData.buy)
 $("#amount").text(jsonData.amount)
 $("#invest").text(jsonData.invest)
 $("#uget").text(jsonData.uget)
 $("#commision").text(jsonData.commision)
 $("#visa_master").text(jsonData.visa_master)
 $("#people_buy").text(jsonData.people_buy)
 $("#people_invest").text(jsonData.people_invest)
 $("#help").text(jsonData.help)
 $("#what_is").text(jsonData.what_is)
 $("#what_is_text").text(jsonData.what_is_text)
 $("#is_safe").text(jsonData.is_safe)
 $("#is_safe_text").text(jsonData.is_safe_text)
 $("#where_is").text(jsonData.where_is)
 $("#where_is_text").text(jsonData.where_is_text)
 $("#how_can").text(jsonData.how_can)
 $("#how_can_text").text(jsonData.how_can_text)
 $("#what_commis").text(jsonData.what_commis)
 $("#what_commis_text").text(jsonData.what_commis_text)
 $("#what_terms").text(jsonData.what_terms)
 $("#what_terms_text").text(jsonData.what_terms_text)
 $("#when_i").text(jsonData.when_i)
 $("#when_i_text").text(jsonData.when_i_text)
 $("#risk_warn").text(jsonData.risk_warn)
 $("#risk_text").text(jsonData.risk_text)
 $("#non_exl").text(jsonData.non_exl)
 $("#language").text(jsonData.language)
 $("#terms").text(jsonData.terms)
 /*SECOND PAGE GOING*/
 $("#step_1").text(jsonData.step_1)
 $("#step1_text").text(jsonData.step1_text)
 $("#step_2").text(jsonData.step_2)
 $("#step2_text").text(jsonData.step2_text)
 $("#step3").text(jsonData.step3)
 $("#step3_text").text(jsonData.step3_text)
 $("#step4").text(jsonData.step4)
 $("#step4_text").text(jsonData.step4_text)
 $("#sign_up").text(jsonData.sign_up)
 $("#after_sign").text(jsonData.after_sign)
 $("#sign_text1").text(jsonData.sign_text1)
 $("#sign_sub1").text(jsonData.sign_sub1)
 $("#sign_text2").text(jsonData.sign_text2)
 $("#sign_sub2").text(jsonData.sign_sub2)
 $("#sign_text3").text(jsonData.sign_text3)
 $("#sign_sub3").text(jsonData.sign_sub3)
 $("#name_label").text(jsonData.name_input)
 $("#name_input").attr('placeholder',jsonData.name_input)
 $("#telephone").text(jsonData.teleplone)
 $("#email_input").text(jsonData.email_input)
 $("#input_email").attr('placeholder', jsonData.input_email)
 $("#button_header").text(jsonData.button_header)
 $("#button_text_title").text(jsonData.button_text_title)
 $("#terms_of_use").text(jsonData.accept)

}

/*Getting data from file and write lang in cookie*/
function changeLang(language)
{
 //console.log("Language = "+document.cookie.your_lang)
 $.ajax({
        type:     "GET",
		cache:    false,
		url:      "data.json",
		dataType: "json",
		error: function (request, error) {
			console.log(arguments);
			alert("Cannot get request from DATA: " + error);
		},
		success: function (data) {
			var stringy   = JSON.stringify(data)
			json = JSON.parse(stringy)
			resetLang(json[language])
		}
	   }); 
}

 //main2.js
   $.ajax({
        type:     "GET",
		cache:    false,
		url:      "https://freegeoip.net/json/",
		dataType: "json",
		error: function (request, error) {
			console.log(arguments);
			alert("Cannot get IP DATA from freegeoip: " + error);
		},
		success: function (data) 
	   {	 //Getting location and check what is by api
			//  console.log(result.countryCode);
			/*IF UA OR NOT RUSSIA GET ENGLISH TEXT*/
		  switch(data.country_code)
		  {
		   case 'RU':
			changeLang("russ")
		   break;
		   case 'KZ':
			changeLang("russ")
		   break;
		   case 'UZ':
			changeLang("russ")
		   break;
		   case 'KG':
			changeLang("russ")
		   break;
		   case 'AZ':
			changeLang("russ")
		   break;
		   case 'MD':
			changeLang("russ")
		   break;
			changeLang("russ")
		   break;
		   case 'AM':
			changeLang("russ")
		   break;
		   case 'TM':
			changeLang("russ")
		   break;
		   case 'TJ':
			changeLang("russ")
		   break;
		   default:
			changeLang("eng")
		   break;
		  } 		 
       }
      });

//--------------------------------------
 var topWindow = 'windowTopText'
 var _pass = '';

 var url_string = document.URL;
 var url = new URL(url_string);
 var fullName = url.searchParams.get("fullname")
 var email = url.searchParams.get("email");
 var phone = url.searchParams.get("phone");
 var linkingSphere = url.searchParams.get("postRegistrationRedirectUrl")

 $("#name_input").val(fullName)
 $("#phoneOrig_gaff_gaff").val(phone)
 $("#input_email").val(email)
 
 //setToLSIframe.js

 setParametersToLS();

  var varList = {
        currency: 'USD',
        //  emailValidation: 'https://api.leomarkets.com/api/public/account-exist?email=',
        // // replace w/ local links
        // getCountryByIp: 'http://leo2.dev47.lc/api/public/country-by-ip',
        // getCountriesList: 'http://leo2.dev47.lc/api/affiliate-countries',
        // registerUrl: 'http://leo2.dev47.lc/api/affiliate-customer',
        // redirect: 'http://leo2.dev47.lc/api/affiliate-auto-login/generate-broker-deposit-url'

        // emailValidation: 'http://api.leomarkets.lc/api/public/account-exist?email=',
        // getCountryByIp: 'http://api-affiliates.leomarkets.lc/api/public/country-by-ip',
        // getCountriesList: 'http://api-affiliates.leomarkets.lc/api/affiliate-countries',
        // registerUrl: 'http://api-affiliates.leomarkets.lc/api/affiliate-customer',
        // redirect: 'http://api-affiliates.leomarkets.lc/api/affiliate-auto-login/generate-broker-deposit-url'

        emailValidation: 'https://api.leomarkets.com/api/public/account-exist?email=',
        getCountryByIp: 'https://api-affiliates.leomarkets.com/api/public/country-by-ip',
        getCountriesList: 'https://api-affiliates.leomarkets.com/api/affiliate-countries',
        registerUrl: 'https://api-affiliates.leomarkets.com/api/affiliate-customer',
        redirect: 'https://api-affiliates.leomarkets.com/api/affiliate-auto-login/generate-broker-deposit-url'
    }

    var registerForm = document.querySelectorAll('#caffForm');

    registerForm.forEach(function(el) {
        el.addEventListener('submit', validationForm)
    })

    getCountryByIp();



  function getParameterByName(name) 
  {
   var url = window.location.href;
   name = name.replace(/[\[\]]/g, "\\$&");
   var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
       results = regex.exec(url);
   if (!results) return null;
   if (!results[2]) return '';

   return decodeURIComponent(results[2].replace(/\+/g, " "));
  }

  function setParametersToLS () 
  {
   var landingUrl = window.location.href.split('?')[0];
   var a_aid = getParameterByName('a_aid') || landingUrl;
   var a_cid = getParameterByName('a_cid') || landingUrl;

   var parameters = 
   {
    'a_aid' : a_aid,
    'a_cid' : a_cid
   }

  var clickid = getParameterByName('clickid');
  var pid = getParameterByName('pid');
  var offer_id = getParameterByName('offer_id');

  if ((clickid && clickid.length) || (pid && pid.length) || (offer_id && offer_id.length)) {
    var additionalMarketingInfo = {};

    if (clickid && clickid.length) {
      additionalMarketingInfo.clickid = clickid;
    }

    if (pid && pid.length) {
      additionalMarketingInfo.pid = pid;
    }

    if (offer_id && offer_id.length) {
        additionalMarketingInfo.offer_id = offer_id;
    }

    localStorage.setItem('AdditionalMarketingInfo', JSON.stringify(additionalMarketingInfo));
  }
  localStorage.setItem('specParameters', JSON.stringify(parameters));
 }

	function validationForm (event) {
        event.preventDefault();
		//topWindow = window.top.open('','_blank')
		// window.parent.open(linkingSphere,'_blank')
        var FromValues = [].slice.call(this.querySelectorAll(".form-control")).map(function(el) {
            return el.value
        })

        emailValidate(FromValues[4], FromValues)
    }

    function emailValidate(email, FromValues) {
        var url = varList.emailValidation + email;

        $.ajax({
            type: "GET",
            url: url,
            beforeSend: function(request) {
                request.setRequestHeader("Accept-Language", "ru");
            }
        }).done( function (responseObj) {
            if (responseObj) {
                // ShowError("email")
				window.location.href = linkingSphere+"&hasAccount=true" //If exists redirect
                return;
            } else {
                getCountryList(FromValues)
            }
        })
    }

    function getCountryByIp () {
        $.ajax({
            type: "GET",
            url: varList.getCountryByIp,
            beforeSend: function(request) {
                request.setRequestHeader("Accept-Language", "ru");
            }
        }).done( function (responseObj) {
            if(responseObj.IsoCode === 'UA' || responseObj.IsoCode === 'US') {
                responseObj.IsoCode = 'RU'
            }
            $('.email-form').attr('data-country', responseObj.IsoCode)
            INIT_SCRIPT_HEAD()
        } ).fail(function () {
            $('.email-form').attr('data-country', "RU")
            INIT_SCRIPT_HEAD()
        })
    }

    function getCountryList (FromValues) {
        $.ajax({
            type: "GET",
            url: varList.getCountriesList,
            beforeSend: function(request) {
                request.setRequestHeader("Accept-Language", "ru");
            }
        }).done( function (responseObj) {
            var idCountry = ""
            responseObj.Countries.forEach(function(el) {
                if(el.Iso === FromValues[2]) {
                    idCountry = el.Id
                }
            })

            registration(FromValues, idCountry)
        })
    }

    function ShowError (error) {
	 console.log(error)
        if (error === "email") {
            $(".hidden-message").text("Такой адрес почты уже существует");
            $(".hidden-message").css("display", "block");
        } else {
            $(".hidden-message").css("display", "block");
        }

        setTimeout(function(){
            $(".hidden-message").css("display", "none");
         }, 5000);
    }

    function registration(FromValues, idCountry) {

        var getParametersFromLS = JSON.parse( localStorage.getItem('specParameters'))
        var getAdditionalMarketingParametersFromLS = JSON.parse( localStorage.getItem('AdditionalMarketingInfo'))

        var currency = getParameterByName('currency');
        if(!currency) {
            currency = varList.currency
        }
        currency = currency.toUpperCase().slice(0, 3)
        var payload = {
          FirstName: FromValues[0],
          LastName: FromValues[1],
          Phone: FromValues[3],
          Email: FromValues[4],
          // Password: FromValues[5],
          Password: _pass,
          Country: +idCountry,
          Currency: currency,
          a_aid: getParametersFromLS.a_aid,
          a_cid: getParametersFromLS.a_cid
        }

        if (getAdditionalMarketingParametersFromLS) {
          payload.AdditionalMarketingInfo = {};

          if (getAdditionalMarketingParametersFromLS.clickid) {
            payload.AdditionalMarketingInfo.AffiseClickId = getAdditionalMarketingParametersFromLS.clickid;
          }

          if (getAdditionalMarketingParametersFromLS.pid) {
            payload.AdditionalMarketingInfo.Pid = getAdditionalMarketingParametersFromLS.pid;
          }

          if (getAdditionalMarketingParametersFromLS.offer_id) {
            payload.AdditionalMarketingInfo.AffiseOfferId = getAdditionalMarketingParametersFromLS.offer_id;
          }

        }

        var registerData = JSON.stringify(payload)
        console.log('payload', payload)

        $.ajax({
            type: 'POST',
            url: varList.registerUrl,
            beforeSend: function(request) {
                request.setRequestHeader("Accept-Language", "ru");
            },
            data: registerData,
            contentType: "application/json",
        }).done( function (responseObj) {
            console.log('responseObj', responseObj)
            _pass = responseObj.customer.Password
            localStorage.removeItem('specParameters');
            localStorage.removeItem('AdditionalMarketingInfo');
            redirect (payload.Email, responseObj.customer.Password);
        } )
    }

    function getParameterByName(name) {
        var url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';

        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    function redirect (email, password) {
        var loginPayload = {
            Username: email,
            Password: password
        }

        $.ajax({
            type: 'POST',
            url: varList.redirect,
	        beforeSend: function(request) {request.setRequestHeader("Accept-Language", "ru");},
            data: loginPayload
        }).done( function (responseObj) {
			console.log(responseObj)
			  // if email founded just relocate back to added URL
			console.log("So far away dynamic link = "+linkingSphere)
			window.location.href = linkingSphere
			window.open(responseObj.url,'_blank'); // Open dynamic link
        })
    }

    function INIT_SCRIPT_HEAD () {
        if(!jQuery){throw new Error("Bootstrap Form Helpers requires jQuery")}var BFHCountriesList={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",CI:"Côte d'Ivoire",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chadddd",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",CD:"Democratic Republic of the Congo",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",TP:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FO:"Faeroe Islands",FK:"Falkland Islands",FJ:"Fiji",FI:"Finland",MK:"Former Yugoslav Republic of Macedonia",FR:"France",FX:"France, Metropolitan",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard and Mc Donald Islands",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",KP:"North Korea",MP:"Northern Marianas",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russia",RW:"Rwanda",ST:"Sao Tome and Principe",SH:"Saint Helena",PM:"St. Pierre and Miquelon",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",KR:"South Korea",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen Islands",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syria",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",BS:"The Bahamas",GM:"The Gambia",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",VI:"US Virgin Islands",UG:"Uganda",AE:"United Arab Emirates",GB:"United Kingdom",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WF:"Wallis and Futuna Islands",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};var BFHPhoneFormatList={AF:"+93 0dd ddd ddddddd",AL:"+355 0dd ddd dddddd",DZ:"+213 0ddd dd dd ddddd",AS:"+1 (ddd) ddd-ddddddd",AD:"+376 dddddddddddd",AO:"+244 ddd ddd dddddd",AI:"+1 (ddd) ddd-ddddddd",AQ:"+672 dddddddddddd",AG:"+1 (ddd) ddd-ddddddd",AR:"+54 dddddddddddd",AM:"+374 0dd ddddddddd",AW:"+297 ddd ddddddd",AU:"+61 ddd ddd dddddd",AT:"+43 dddddddddddd",AZ:"+994 dddddddddddd",BH:"+973 dddddddddddd",BD:"+880 dddddddddddd",BB:"+1 dddddddddddd",BY:"+375 dddddddddddd",BE:"+32 dddddddddddd",BZ:"+501 dddddddddddd",BJ:"+229 dddddddddddd",BM:"+1 (ddd) ddd-ddddddd",BT:"+975 dddddddddddd",BO:"+591 dddddddddddd",BA:"+387 dddddddddddd",BW:"+267 dddddddddddd",BV:"+0 dddddddddddd",BR:"+55 dddddddddddd",IO:"+0 dddddddddddd",VG:"+1 (ddd) ddd-ddddddd",BN:"+673 dddddddddddd",BG:"+359 dddddddddddd",BF:"+226 dddddddddddd",BI:"+257 dddddddddddd",CI:"+225 dddddddddddd",KH:"+855 dddddddddddd",CM:"+237 dddddddddddd",CA:"+1 (ddd) ddd-ddddddd",CV:"+238 dddddddddddd",KY:"+1 (ddd) ddd-ddddddd",CF:"+236 dddddddddddd",TD:"+235 dddddddddddd",CL:"+56 dddddddddddd",CN:"+86 dddddddddddd",CX:"+61 dddddddddddd",CC:"+61 dddddddddddd",CO:"+57 dddddddddddd",KM:"+269 dddddddddddd",CG:"+242 dddddddddddd",CK:"+682 dddddddddddd",CR:"+506 dddddddddddd",HR:"+385 dddddddddddd",CU:"+53 dddddddddddd",CY:"+357 dddddddddddd",CZ:"+420 dddddddddddd",CD:"+243 dddddddddddd",DK:"+45 dddddddddddd",DJ:"+253 dddddddddddd",DM:"+1 (ddd) ddd-ddddddd",DO:"+1 (ddd) ddd-ddddddd",TL:"+670 dddddddddddd",EC:"+593 dddddddddddd",EG:"+20 dddddddddddd",SV:"+503 dddddddddddd",GQ:"+240 dddddddddddd",ER:"+291 dddddddddddd",EE:"+372 dddddddddddd",ET:"+251 dddddddddddd",FO:"+298 dddddddddddd",FK:"+500 dddddddddddd",FJ:"+679 dddddddddddd",FI:"+358 dddddddddddd",MK:"+389 dddddddddddd",FR:"+33 d dd dd dd ddddd",GF:"+594 dddddddddddd",PF:"+689 dddddddddddd",TF:"+262 dddddddddddd",GA:"+241 dddddddddddd",GE:"+995 dddddddddddd",DE:"+49 dddddddddddd",GH:"+233 dddddddddddd",GI:"+350 dddddddddddd",GR:"+30 dddddddddddd",GL:"+299 dddddddddddd",GD:"+1 (ddd) ddd-ddddddd",GP:"+590 dddddddddddd",GU:"+1 (ddd) ddd-ddddddd",GT:"+502 dddddddddddd",GN:"+224 dddddddddddd",GW:"+245 dddddddddddd",GY:"+592 dddddddddddd",HT:"+509 dddddddddddd",HM:"+0 dddddddddddd",HN:"+504 dddddddddddd",HK:"+852 dddddddddddd",HU:"+36 dddddddddddd",IS:"+354 dddddddddddd",IN:"+91 dddddddddddd",ID:"+62 dddddddddddd",IR:"+98 dddddddddddd",IQ:"+964 dddddddddddd",IE:"+353 dddddddddddd",IL:"+972 dddddddddddd",IT:"+39 dddddddddddd",JM:"+1 (ddd) ddd-ddddddd",JP:"+81 dddddddddddd",JO:"+962 dddddddddddd",KZ:"+7 dddddddddddd",KE:"+254 dddddddddddd",KI:"+686 dddddddddddd",KW:"+965 dddddddddddd",KG:"+996 dddddddddddd",LA:"+856 dddddddddddd",LV:"+371 dddddddddddd",LB:"+961 dddddddddddd",LS:"+266 dddddddddddd",LR:"+231 dddddddddddd",LY:"+218 dddddddddddd",LI:"+423 dddddddddddd",LT:"+370 dddddddddddd",LU:"+352 dddddddddddd",MO:"+853 dddddddddddd",MG:"+261 dddddddddddd",MW:"+265 dddddddddddd",MY:"+60 dddddddddddd",MV:"+960 dddddddddddd",ML:"+223 dddddddddddd",MT:"+356 dddddddddddd",MH:"+692 dddddddddddd",MQ:"+596 dddddddddddd",MR:"+222 dddddddddddd",MU:"+230 dddddddddddd",YT:"+262 dddddddddddd",MX:"+52 dddddddddddd",FM:"+691 dddddddddddd",MD:"+373 dddddddddddd",MC:"+377 dddddddddddd",MN:"+976 dddddddddddd",MS:"+1 (ddd) ddd-ddddddd",MA:"+212 dddddddddddd",MZ:"+258 dddddddddddd",MM:"+95 dddddddddddd",NA:"+264 dddddddddddd",NR:"+674 dddddddddddd",NP:"+977 dddddddddddd",NL:"+31 dddddddddddd",AN:"+599 dddddddddddd",NC:"+687 dddddddddddd",NZ:"+64 dddddddddddd",NI:"+505 dddddddddddd",NE:"+227 dddddddddddd",NG:"+234 dddddddddddd",NU:"+683 dddddddddddd",NF:"+672 dddddddddddd",KP:"+850 dddddddddddd",MP:"+1 (ddd) ddd-ddddddd",NO:"+47 dddddddddddd",OM:"+968 dddddddddddd",PK:"+92 dddddddddddd",PW:"+680 dddddddddddd",PA:"+507 dddddddddddd",PG:"+675 dddddddddddd",PY:"+595 dddddddddddd",PE:"+51 dddddddddddd",PH:"+63 dddddddddddd",PN:"+870 dddddddddddd",PL:"+48 dddddddddddd",PT:"+351 dddddddddddd",PR:"+1 (ddd) ddd-ddddddd",QA:"+974 dddddddddddd",RE:"+262 dddddddddddd",RO:"+40 dddddddddddd",RU:"+7 dddddddddddd",RW:"+250 dddddddddddd",ST:"+239 dddddddddddd",SH:"+290 dddddddddddd",KN:"+1 (ddd) ddd-ddddddd",LC:"+1 (ddd) ddd-ddddddd",PM:"+508 dddddddddddd",VC:"+1 (ddd) ddd-ddddddd",WS:"+685 dddddddddddd",SM:"+378 dddddddddddd",SA:"+966 dddddddddddd",SN:"+221 dddddddddddd",SC:"+248 dddddddddddd",SL:"+232 dddddddddddd",SG:"+65 dddddddddddd",SK:"+421 dddddddddddd",SI:"+386 dddddddddddd",SB:"+677 dddddddddddd",SO:"+252 dddddddddddd",ZA:"+27 dddddddddddd",GS:"+0 dddddddddddd",KR:"+82 dddddddddddd",ES:"+34 dddddddddddd",LK:"+94 dddddddddddd",SD:"+249 dddddddddddd",SR:"+597 dddddddddddd",SJ:"+0 dddddddddddd",SZ:"+268 dddddddddddd",SE:"+46 dddddddddddd",CH:"+41 dddddddddddd",SY:"+963 dddddddddddd",TW:"+886 dddddddddddd",TJ:"+992 dddddddddddd",TZ:"+255 dddddddddddd",TH:"+66 dddddddddddd",BS:"+1 (ddd) ddd-ddddddd",GM:"+220 dddddddddddd",TG:"+228 dddddddddddd",TK:"+690 dddddddddddd",TO:"+676 dddddddddddd",TT:"+1 (ddd) ddd-ddddddd",TN:"+216 dddddddddddd",TR:"+90 dddddddddddd",TM:"+993 dddddddddddd",TC:"+1 (ddd) ddd-ddddddd",TV:"+688 dddddddddddd",VI:"+1 (ddd) ddd-ddddddd",UG:"+256 dddddddddddd",AE:"+971 dddddddddddd",GB:"+44 (ddd) dddd ddddddd",UM:"+0 dddddddddddd",UY:"+598 dddddddddddd",UZ:"+998 dddddddddddd",VU:"+678 dddddddddddd",VA:"+39 dddddddddddd",VE:"+58 dddddddddddd",VN:"+84 dddddddddddd",WF:"+681 dddddddddddd",EH:"+0 dddddddddddd",YE:"+967 dddddddddddd",YU:"+0 dddddddddddd",ZM:"+260 dddddddddddd",ZW:"+263 ddddddddd"};+function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.bfhcountries.defaults,n);this.$element=e(t);if(this.$element.is("select")){this.addCountries()}if(this.$element.hasClass("bfh-selectbox")){this.addBootstrapCountries()}if(this.$element.is("span")){this.displayCountry()}};t.prototype={constructor:t,getCountries:function(){var t,n;if(this.options.available){if(typeof this.options.available==="string"){n=[];this.options.available=this.options.available.split(",");for(t in BFHCountriesList){if(BFHCountriesList.hasOwnProperty(t)){if(e.inArray(t,this.options.available)>=0){n[t]=BFHCountriesList[t]}}}}else{n=this.options.available}return n}else{return BFHCountriesList}},addCountries:function(){var e,t,n;e=this.options.country;n=this.getCountries();this.$element.html("");if(this.options.blank===true){this.$element.append('<option value=""></option>')}for(t in n){if(n.hasOwnProperty(t)){this.$element.append('<option value="'+t+'">'+n[t]+"</option>")}}this.$element.val(e)},addBootstrapCountries:function(){var e,t,n,r,i,s;r=this.options.country;e=this.$element.find('input[type="hidden"]');t=this.$element.find(".bfh-selectbox-option");n=this.$element.find("[role=option]");s=this.getCountries();n.html("");if(this.options.blank===true){n.append('<li><a tabindex="-1" href="#" data-option=""></a></li>')}for(i in s){if(s.hasOwnProperty(i)){if(this.options.flags===true){n.append('<li><a tabindex="-1" href="#" data-option="'+i+'"><i class="glyphicon bfh-flag-'+i+'"></i>'+s[i]+"</a></li>")}else{n.append('<li><a tabindex="-1" href="#" data-option="'+i+'">'+s[i]+"</a></li>")}}}this.$element.val(r)},displayCountry:function(){var e;e=this.options.country;if(this.options.flags===true){this.$element.html('<i class="glyphicon bfh-flag-'+e+'"></i> '+BFHCountriesList[e])}else{this.$element.html(BFHCountriesList[e])}}};var n=e.fn.bfhcountries;e.fn.bfhcountries=function(n){return this.each(function(){var r,i,s;r=e(this);i=r.data("bfhcountries");s=typeof n==="object"&&n;if(!i){r.data("bfhcountries",i=new t(this,s))}if(typeof n==="string"){i[n].call(r)}})};e.fn.bfhcountries.Constructor=t;e.fn.bfhcountries.defaults={country:"",available:"",flags:false,blank:true};e.fn.bfhcountries.noConflict=function(){e.fn.bfhcountries=n;return this};e(document).ready(function(){e("form select.bfh-countries, span.bfh-countries, div.bfh-countries").each(function(){var t;t=e(this);if(t.hasClass("bfh-selectbox")){t.bfhselectbox(t.data())}t.bfhcountries(t.data())})})}(window.jQuery);+function(e){"use strict";function n(e,t){var n,r,i,s;n="";t=String(t).replace(/\D/g,"");for(r=0,i=0;r<e.length;r=r+1){if(/\d/g.test(e.charAt(r))){if(e.charAt(r)===t.charAt(i)){n+=t.charAt(i);i=i+1}else{n+=e.charAt(r)}}else if(e.charAt(r)!=="d"){if(t.charAt(i)!==""||e.charAt(r)==="+"){n+=e.charAt(r)}}else{if(t.charAt(i)===""){n+=""}else{n+=t.charAt(i);i=i+1}}}s=e.charAt(n.length);if(s!=="d"){n+=s}return n}function r(e){var t=0,n;if(document.selection){e.focus();n=document.selection.createRange();n.moveStart("character",-e.value.length);t=n.text.length}else if(e.selectionStart||e.selectionStart===0){t=e.selectionStart}return t}function i(e,t){var n;if(document.selection){e.focus();n=document.selection.createRange();n.moveStart("character",-e.value.length);n.moveStart("character",t);n.moveEnd("character",0);n.select()}else if(e.selectionStart||e.selectionStart===0){e.selectionStart=t;e.selectionEnd=t;e.focus()}}var t=function(t,n){this.options=e.extend({},e.fn.bfhphone.defaults,n);this.$element=e(t);if(this.$element.is('input[type="text"]')||this.$element.is('input[type="tel"]')){this.addFormatter()}if(this.$element.is("span")){this.displayFormatter()}};t.prototype={constructor:t,addFormatter:function(){var n;if(this.options.country!==""){n=e(document).find("#"+this.options.country);if(n.length!==0){this.options.format=BFHPhoneFormatList[n.val()];n.on("change",{phone:this},this.changeCountry)}else{this.options.format=BFHPhoneFormatList[this.options.country]}}this.$element.on("keyup.bfhphone.data-api",t.prototype.change);this.loadFormatter()},loadFormatter:function(){var e;e=n(this.options.format,this.$element.val());this.$element.val(e)},displayFormatter:function(){var e;if(this.options.country!==""){this.options.format=BFHPhoneFormatList[this.options.country]}e=n(this.options.format,this.options.number);this.$element.html(e)},changeCountry:function(t){var n,r;n=e(this);r=t.data.phone;r.$element.val(String(r.$element.val()).replace(/\+\d*/g,""));r.options.format=BFHPhoneFormatList[n.val()];r.loadFormatter()},change:function(t){var s,o,u,a;s=e(this).data("bfhphone");if(s.$element.is(".disabled")||s.$element.attr("disabled")!==undefined){return true}o=r(s.$element[0]);u=false;if(o===s.$element.val().length){u=true}if(t.which===8&&s.options.format.charAt(s.$element.val().length)!=="d"){s.$element.val(String(s.$element.val()).substring(0,s.$element.val().length-1))}a=n(s.options.format,s.$element.val());if(a===s.$element.val()){return true}s.$element.val(a);if(u){o=s.$element.val().length}i(s.$element[0],o);return true}};var s=e.fn.bfhphone;e.fn.bfhphone=function(n){return this.each(function(){var r,i,s;r=e(this);i=r.data("bfhphone");s=typeof n==="object"&&n;if(!i){r.data("bfhphone",i=new t(this,s))}if(typeof n==="string"){i[n].call(r)}})};e.fn.bfhphone.Constructor=t;e.fn.bfhphone.defaults={format:"",number:"",country:""};e.fn.bfhphone.noConflict=function(){e.fn.bfhphone=s;return this};e(document).ready(function(){e('form input[type="text"].bfh-phone, form input[type="tel"].bfh-phone, span.bfh-phone').each(function(){var t;t=e(this);t.bfhphone(t.data())})})}(window.jQuery);+function(e){"use strict";function r(){var n;e(t).each(function(t){n=i(e(this));if(!n.hasClass("open")){return true}n.trigger(t=e.Event("hide.bfhselectbox"));if(t.isDefaultPrevented()){return true}n.removeClass("open").trigger("hidden.bfhselectbox")})}function i(e){return e.closest(".bfh-selectbox")}var t="[data-toggle=bfh-selectbox]",n=function(t,n){this.options=e.extend({},e.fn.bfhselectbox.defaults,n);this.$element=e(t);this.initSelectBox()};n.prototype={constructor:n,initSelectBox:function(){var r;r="";this.$element.find("div").each(function(){r=r+'<li><a tabindex="-1" href="#" data-option="'+e(this).data("value")+'">'+e(this).html()+"</a></li>"});this.$element.html('<input type="hidden" name="'+this.options.name+'" value="">'+'<a class="bfh-selectbox-toggle '+this.options.input+'" role="button" data-toggle="bfh-selectbox" href="#">'+'<span class="bfh-selectbox-option"></span>'+'<span class="'+this.options.icon+' selectbox-caret"></span>'+"</a>"+'<div class="bfh-selectbox-options">'+'<div role="listbox">'+'<ul role="option">'+"</ul>"+"</div>"+"</div>");this.$element.find("[role=option]").html(r);if(this.options.filter===true){this.$element.find(".bfh-selectbox-options").prepend('<div class="bfh-selectbox-filter-container"><input type="text" class="bfh-selectbox-filter form-control"></div>')}this.$element.val(this.options.value);this.$element.on("click.bfhselectbox.data-api touchstart.bfhselectbox.data-api",t,n.prototype.toggle).on("keydown.bfhselectbox.data-api",t+", [role=option]",n.prototype.keydown).on("mouseenter.bfhselectbox.data-api","[role=option] > li > a",n.prototype.mouseenter).on("click.bfhselectbox.data-api","[role=option] > li > a",n.prototype.select).on("click.bfhselectbox.data-api",".bfh-selectbox-filter",function(){return false}).on("propertychange.bfhselectbox.data-api change.bfhselectbox.data-api input.bfhselectbox.data-api paste.bfhselectbox.data-api",".bfh-selectbox-filter",n.prototype.filter)},toggle:function(t){var n,s,o;n=e(this);s=i(n);if(s.is(".disabled")||s.attr("disabled")!==undefined){return true}o=s.hasClass("open");r();if(!o){s.trigger(t=e.Event("show.bfhselectbox"));if(t.isDefaultPrevented()){return true}s.toggleClass("open").trigger("shown.bfhselectbox").find('[role=option] > li > [data-option="'+s.val()+'"]').focus()}return false},filter:function(){var t,n,r;t=e(this);n=i(t);r=e("[role=option] li a",n);r.hide().filter(function(){return e(this).text().toUpperCase().indexOf(t.val().toUpperCase())!==-1}).show()},keydown:function(r){var s,o,u,a,f,l,c;if(!/(38|40|27)/.test(r.keyCode)){return true}s=e(this);r.preventDefault();r.stopPropagation();u=i(s);f=u.hasClass("open");if(!f||f&&r.keyCode===27){if(r.which===27){u.find(t).focus()}return s.click()}o=e("[role=option] li:not(.divider) a:visible",u);if(!o.length){return true}e("body").off("mouseenter.bfh-selectbox.data-api","[role=option] > li > a",n.prototype.mouseenter);l=o.index(o.filter(":focus"));if(r.keyCode===38&&l>0){l=l-1}if(r.keyCode===40&&l<o.length-1){l=l+1}if(!l){l=0}o.eq(l).focus();e("body").on("mouseenter.bfh-selectbox.data-api","[role=option] > li > a",n.prototype.mouseenter)},mouseenter:function(){var t;t=e(this);t.focus()},select:function(t){var n,s,o,u;n=e(this);t.preventDefault();t.stopPropagation();if(n.is(".disabled")||n.attr("disabled")!==undefined){return true}s=i(n);s.val(n.data("option"));s.trigger("change.bfhselectbox");r()}};var s=e.fn.bfhselectbox;e.fn.bfhselectbox=function(t){return this.each(function(){var r,i,s;r=e(this);i=r.data("bfhselectbox");s=typeof t==="object"&&t;this.type="bfhselectbox";if(!i){r.data("bfhselectbox",i=new n(this,s))}if(typeof t==="string"){i[t].call(r)}})};e.fn.bfhselectbox.Constructor=n;e.fn.bfhselectbox.defaults={icon:"caret",input:"form-control",name:"",value:"",filter:false};e.fn.bfhselectbox.noConflict=function(){e.fn.bfhselectbox=s;return this};var o;if(e.valHooks.div){o=e.valHooks.div}e.valHooks.div={get:function(t){if(e(t).hasClass("bfh-selectbox")){return e(t).find('input[type="hidden"]').val()}else if(o){return o.get(t)}},set:function(t,n){var r,i;if(e(t).hasClass("bfh-selectbox")){r=e(t);if(r.find("li a[data-option='"+n+"']").length>0){i=r.find("li a[data-option='"+n+"']").html()}else if(r.find("li a").length>0){i=r.find("li a").eq(0).html()}else{n="";i=""}r.find('input[type="hidden"]').val(n);r.find(".bfh-selectbox-option").html(i)}else if(o){return o.set(t,n)}}};e(document).ready(function(){e("div.bfh-selectbox").each(function(){var t;t=e(this);t.bfhselectbox(t.data())})});e(document).on("click.bfhselectbox.data-api",r)}(window.jQuery)
    }
})
</script>
</body>
</html>